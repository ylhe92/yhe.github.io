

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Intersection &mdash; highway-env  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User Guide" href="../user_guide.html" />
    <link rel="prev" title="Parking" href="parking.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> highway-env
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../quickstart.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../quickstart.html#making-an-environment">Making an environment</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../quickstart.html#all-the-environments">All the environments</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="highway.html">Highway</a></li>
<li class="toctree-l4"><a class="reference internal" href="merge.html">Merge</a></li>
<li class="toctree-l4"><a class="reference internal" href="roundabout.html">Roundabout</a></li>
<li class="toctree-l4"><a class="reference internal" href="parking.html">Parking</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Intersection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#configuring-an-environment">Configuring an environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#training-an-agent">Training an agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#examples-on-google-colab">Examples on Google Colab</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography/index.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">highway-env</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../quickstart.html">Getting Started</a> &raquo;</li>
        
      <li>Intersection</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/environments/intersection.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="intersection">
<span id="environments-intersection"></span><h1>Intersection<a class="headerlink" href="#intersection" title="Permalink to this headline">¶</a></h1>
<p>An intersection negotiation task with dense traffic.</p>
<div class="figure align-center" id="fig-intersection-env">
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/eleurent/highway-env/gh-media/docs/media/intersection-env.gif"><img alt="https://raw.githubusercontent.com/eleurent/highway-env/gh-media/docs/media/intersection-env.gif" src="https://raw.githubusercontent.com/eleurent/highway-env/gh-media/docs/media/intersection-env.gif" style="width: 80%;" /></a>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It’s quite hard to come up with good decentralized behaviors for other agents to avoid each other. Of course, this
could be achieved by sophisticated centralized schedulers, or traffic lights, but to keep things simple a
<a class="reference internal" href="../dynamics/road/regulation.html#road-regulation"><span class="std std-ref">rudimentary collision prediction</span></a> was added in the behaviour of other vehicles.</p>
<p>This simple system sometime fails which results in collisions, blocking the way for the ego-vehicle.
I figured it was fine for my own purpose, since it did not happen too often and it’s reasonable to expect
the ego-vehicle to simply wait the end of episode in these situations. But I agree that it is not ideal,
and I welcome any contribution on that matter.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;intersection-v0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="default-configuration">
<h2>Default configuration<a class="headerlink" href="#default-configuration" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;observation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Kinematics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vehicles_count&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;presence&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;vx&quot;</span><span class="p">,</span> <span class="s2">&quot;vy&quot;</span><span class="p">,</span> <span class="s2">&quot;cos_h&quot;</span><span class="p">,</span> <span class="s2">&quot;sin_h&quot;</span><span class="p">],</span>
        <span class="s2">&quot;features_range&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
            <span class="s2">&quot;vx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
            <span class="s2">&quot;vy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="s2">&quot;absolute&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;flatten&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;observe_intentions&quot;</span><span class="p">:</span> <span class="kc">False</span>
    <span class="p">},</span>
    <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;DiscreteMetaAction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;longitudinal&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;lateral&quot;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">},</span>
    <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>  <span class="c1"># [s]</span>
    <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;o1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;initial_vehicle_count&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;spawn_probability&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="s2">&quot;screen_width&quot;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="s2">&quot;screen_height&quot;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="s2">&quot;centering_position&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
    <span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="mf">5.5</span> <span class="o">*</span> <span class="mf">1.3</span><span class="p">,</span>
    <span class="s2">&quot;collision_reward&quot;</span><span class="p">:</span> <span class="n">IntersectionEnv</span><span class="o">.</span><span class="n">COLLISION_REWARD</span><span class="p">,</span>
    <span class="s2">&quot;normalize_reward&quot;</span><span class="p">:</span> <span class="kc">False</span>
<span class="p">}</span>
</pre></div>
</div>
<p>More specifically, it is defined in:</p>
<dl class="py method">
<dt id="highway_env.envs.intersection_env.IntersectionEnv.default_config">
<em class="property">classmethod </em><code class="sig-prename descclassname">IntersectionEnv.</code><code class="sig-name descname">default_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="../_modules/highway_env/envs/intersection_env.html#IntersectionEnv.default_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#highway_env.envs.intersection_env.IntersectionEnv.default_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Default environment configuration.</p>
<p>Can be overloaded in environment implementations, or by calling configure().
:return: a configuration dict</p>
</dd></dl>

</div>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="highway_env.envs.intersection_env.IntersectionEnv">
<em class="property">class </em><code class="sig-prename descclassname">highway_env.envs.intersection_env.</code><code class="sig-name descname">IntersectionEnv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/highway_env/envs/intersection_env.html#IntersectionEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#highway_env.envs.intersection_env.IntersectionEnv" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="id0">
<em class="property">classmethod </em><code class="sig-name descname">default_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="../_modules/highway_env/envs/intersection_env.html#IntersectionEnv.default_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Default environment configuration.</p>
<p>Can be overloaded in environment implementations, or by calling configure().
:return: a configuration dict</p>
</dd></dl>

<dl class="py method">
<dt id="highway_env.envs.intersection_env.IntersectionEnv.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/highway_env/envs/intersection_env.html#IntersectionEnv.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#highway_env.envs.intersection_env.IntersectionEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to it’s initial configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the observation of the reset state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="highway_env.envs.intersection_env.IntersectionEnv.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">action</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>float<span class="p">, </span>bool<span class="p">, </span>dict<span class="p">]</span><a class="reference internal" href="../_modules/highway_env/envs/intersection_env.html#IntersectionEnv.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#highway_env.envs.intersection_env.IntersectionEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an action and step the environment dynamics.</p>
<p>The action is executed by the ego-vehicle, and all other vehicles on the road performs their default behaviour
for several simulation timesteps until the next decision making step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> – the action performed by the ego-vehicle</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple (observation, reward, terminal, info)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../user_guide.html" class="btn btn-neutral float-right" title="User Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="parking.html" class="btn btn-neutral float-left" title="Parking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018, Edouard Leurent

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>